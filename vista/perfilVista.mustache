<link rel="stylesheet" href="/assets/css/perfil.css">


<div class="container perfil-container">
    <!-- Cabecera del Perfil -->
    <div class="profile-header">
        <div class="profile-avatar">
            <img src="/{{usuario.foto_perfil}}" alt="Avatar" onerror="this.src='/assets/img/default-avatar.png'">
        </div>
        <div class="profile-info">
            <h1>{{usuario.nombre_completo}}</h1>
            <p class="username">@{{usuario.nombre_usuario}}</p>
            <div class="profile-meta">
                <span class="badge bg-primary">Ranking: #{{posicion}}</span>
                <span class="badge bg-success">{{usuario.pais}}, {{usuario.ciudad}}</span>
                <span class="badge bg-warning">Nivel: {{usuario.nivel}}</span>
            </div>
            
            {{#esPerfilPropio}}
            <!-- Datos adicionales solo para perfil propio -->
            <div class="profile-details mt-3">
                <div class="detail-item">
                    <span class="detail-label">ğŸ“§ Email:</span>
                    <span class="detail-value">{{usuario.email}}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">ğŸ‚ AÃ±o de Nacimiento:</span>
                    <span class="detail-value">{{usuario.anio_nacimiento}}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">ğŸ‘¤ Sexo:</span>
                    <span class="detail-value">{{usuario.sexo}}</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">ğŸ”’ ContraseÃ±a:</span>
                    <span class="detail-value">{{usuario.contrasena_oculta}}</span>
                </div>
            </div>
            {{/esPerfilPropio}}
        </div>
        <div class="profile-qr">
            <div id="qrcode"></div>
            <p class="qr-label">Escanea para ver perfil</p>
        </div>
    </div>

    <div class="stats-section">
        <h2>ğŸ“Š EstadÃ­sticas</h2>
        <div class="row">
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ®</div>
                    <div class="stat-value">{{estadisticas.total_partidas}}</div>
                    <div class="stat-label">Partidas Jugadas</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ†</div>
                    <div class="stat-value">{{estadisticas.partidas_ganadas}}</div>
                    <div class="stat-label">Partidas Ganadas</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-value">{{estadisticas.preguntas_correctas}}</div>
                    <div class="stat-label">Respuestas Correctas</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-value">{{estadisticas.porcentaje_acierto}}%</div>
                    <div class="stat-label">% de Acierto</div>
                </div>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-12">
                <div class="stat-card puntaje-card">
                    <div class="stat-icon">â­</div>
                    <div class="stat-value">{{usuario.puntaje_total}}</div>
                    <div class="stat-label">Puntaje MÃ¡ximo</div>
                </div>
            </div>
        </div>
    </div>

    <div class="history-section">
        <h2> Historial de Partidas</h2>
        {{#partidas}}
        <div class="partida-card">
            <div class="partida-header">
                <span class="partida-modo">
                    {{#esSolitario}} Solitario{{/esSolitario}}
                    {{^esSolitario}} Versus{{/esSolitario}}
                </span>
                <span class="partida-fecha">{{fecha_fin_formateada}}</span>
            </div>
            <div class="partida-body">
                <div class="partida-stats">
                    <span class="stat-item">
                        <strong>{{respuestas_correctas}}</strong> / {{total_respuestas}} correctas
                    </span>
                    <span class="stat-item">
                        Puntaje: <strong>{{puntaje_obtenido}}</strong>
                    </span>
                </div>
                {{#oponente_nombre}}
                <div class="partida-oponente">
                    <small>vs {{oponente_nombre}}</small>
                    {{#esGanador}}
                        <span class="badge bg-success">Victoria</span>
                    {{/esGanador}}
                    {{^esGanador}}
                        <span class="badge bg-danger">Derrota</span>
                    {{/esGanador}}
                </div>
                {{/oponente_nombre}}
            </div>
        </div>
        {{/partidas}}
        
        {{^partidas}}
        <div class="no-partidas">
            <p>Este jugador aÃºn no ha jugado ninguna partida.</p>
        </div>
        {{/partidas}}
    </div>

    <div class="action-buttons">
        {{#esPerfilPropio}}
            <a href="/game/singleplayer" class="btn-custom mb-3">Jugar Ahora</a>
        {{/esPerfilPropio}}
        {{^esPerfilPropio}}
            <button class="btn btn-warning btn-lg" onclick="alert('Funcion para proxima entrega de TP')">
                âš”ï¸ Desafiar
            </button>
        {{/esPerfilPropio}}
        <a href="/ranking/" class="btn-ranking mb-3">Ver Ranking</a>
        <a href="/inicio/" class="btn-inicio mb-3">Volver al Inicio</a>
    </div>
</div>

<script>
    const urlPerfil = "{{urlPerfil}}";
</script>